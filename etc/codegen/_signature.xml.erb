<ds:Signature Id="<%= param('Signature', 'Id') %>">
  <ds:SignedInfo>
    <ds:CanonicalizationMethod Algorithm="<%= param('Signature', 'CanonicalizationMethod', 'Algorithm')%>"/>
    <ds:SignatureMethod Algorithm="<%= param('Signature', 'SignatureMethod', 'Algorithm')%>">
    </ds:SignatureMethod>
    <ds:Reference URI="<%= param('Signature', 'Reference', 'URI')%>">
      <ds:Transforms>
        <% param('Signature', 'Reference', 'Transforms').each do |tr| %>
          <ds:Transform Algorithm="<% param('Algorithm', with: tr) %>">
            <% param('XPath', with: tr).each do |xpath| %>
              <ds:XPath><%= xpath %></ds:XPath>
            <% end %>
          </ds:Transform>
        <% end %>
      </ds:Transforms>
      <ds:DigestMethod Algorithm="<%= param('Signature', 'DigestMethod', 'Algorithm')%>"/>
      <ds:DigestValue><%= param('Signature', 'DigestMethod', 'DigestValue')%></ds:DigestValue>
    </ds:Reference>
  </ds:SignedInfo>
  <ds:SignatureValue></ds:SignatureValue>
  <ds:KeyInfo></ds:KeyInfo>
  <ds:X509Data>
    <ds:X509Certificate><%= param('Signature', 'X509Data', 'X509Certificate')%></ds:X509Certificate>
  </ds:X509Data>
</ds:Signature>